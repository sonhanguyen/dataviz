name: Docker Image CI

on:
  push:
    branches: [ master ]

jobs:

  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Build
      uses: docker/build-push-action@v1
      with:
        # username: ${{ secrets.DOCKER_USERNAME }}
        # password: ${{ secrets.DOCKER_PASSWORD }}
        push: false
        repository: sonha/notebook-render-service
        tags: $GITHUB_SHA
        tag_with_ref: true
    - name: Test
      run: DOCKER_FILE=Dockerfile make test
    
